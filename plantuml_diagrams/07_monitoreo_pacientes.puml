@startuml
!theme plain
skinparam backgroundColor #FFFFFF
skinparam activityBackgroundColor #E8EAF6
skinparam activityBorderColor #3F51B5
skinparam activityFontSize 12
skinparam arrowColor #3F51B5

title Flujo 7: Monitoreo de Pacientes - Dashboard Web (M√©dico)

start

:M√©dico hace login en dashboard;

:Dashboard Principal;

partition "Vista General" {
  :Mostrar KPIs principales;
  
  :CARD 1 - Total Pacientes;
  :N√∫mero grande
  + Tendencia vs mes anterior;
  
  :CARD 2 - Alertas Pendientes;
  :N√∫mero con badge rojo
  + Acci√≥n r√°pida "Ver alertas";
  
  :CARD 3 - Adherencia Promedio;
  :% en grande
  + Gr√°fico sparkline
  + C√≥digo color;
  
  :CARD 4 - Pacientes en Riesgo;
  :Cantidad con adherencia <70%
  + Link r√°pido "Ver lista";
}

partition "Tabla de Pacientes" {
  :Lista de pacientes vinculados;
  
  :Columnas de tabla:
  | Nombre | Edad | Adherencia 7d | Estado | # Meds | √öltima conexi√≥n |;
  
  :Cada fila muestra:
  - Nombre paciente (an√≥nimo si configurado)
  - Edad
  - % adherencia √∫ltimos 7 d√≠as
  - Indicador visual:
    üü¢ ‚â•85% (Excelente)
    üü° 70-84% (Aceptable)
    üî¥ <70% (En riesgo)
  - Cantidad medicamentos activos
  - √öltima vez que abri√≥ la app;
  
  :Ordenamiento por columna;
  :Click en encabezado para ordenar;
  
  :Barra de b√∫squeda;
  :Buscar por nombre paciente;
}

partition "Filtros Avanzados" {
  :Panel de filtros (expandible);
  
  if (¬øFiltro aplicado?) then (Solo en riesgo)
    :Mostrar solo pacientes
    con adherencia <70%;
    :Actualizar contador;
    
  elseif (Por rango adherencia) then
    :Opciones:
    - 90-100% (Excelente)
    - 70-89% (Buena)
    - 50-69% (Regular)
    - <50% (Cr√≠tica);
    
  elseif (Por condici√≥n m√©dica) then
    :Lista condiciones:
    - Hipertensi√≥n
    - Diabetes
    - Cardiopat√≠as
    - Otras;
    
  elseif (Por per√≠odo) then
    :Opciones:
    - √öltimos 7 d√≠as
    - √öltimos 30 d√≠as
    - √öltimos 90 d√≠as
    - Personalizado;
  endif
  
  :Aplicar filtros;
  :Actualizar tabla;
  :Mostrar contador:
  "Mostrando X de Y pacientes";
}

partition "Ver Detalle de Paciente" {
  :M√©dico click en fila paciente;
  
  :P√°gina Detalle Paciente;
  
  :Secci√≥n 1 - Perfil;
  :Mostrar:
  - Nombre
  - Edad, g√©nero
  - Fecha vinculaci√≥n
  - Condiciones m√©dicas registradas;
  
  :Secci√≥n 2 - Adherencia;
  :% adherencia grande;
  :Gr√°fico √∫ltimos 30 d√≠as;
  :Tendencia (mejorando/estable/empeorando);
  
  :Secci√≥n 3 - Medicamentos Activos;
  :Tabla de medicamentos;
  
  :Por cada medicamento:
  - Nombre
  - Dosis y frecuencia
  - Adherencia espec√≠fica (%)
  - √öltima toma registrada
  - Pr√≥xima toma programada;
  
  if (¬øClick en medicamento?) then (S√≠)
    :Expandir detalles:
    - Historial completo
    - Patr√≥n de tomas
    - Horarios programados vs reales
    - Notas del paciente;
  endif
  
  :Secci√≥n 4 - Historial Reciente;
  :Timeline √∫ltimos 14 d√≠as;
  :Mostrar eventos:
  ‚úì Tomas confirmadas
  ‚úó Tomas perdidas
  ‚è∞ Tomas retrasadas
  ‚ûï Medicamentos agregados
  ‚úèÔ∏è Modificaciones;
  
  :Secci√≥n 5 - Alertas;
  if (¬øHay alertas activas?) then (S√≠)
    :Lista de alertas:
    
    ALERTA TIPO 1: Adherencia baja
    "‚ö†Ô∏è Adherencia <70% por 3+ d√≠as";
    
    ALERTA TIPO 2: Inactividad
    "üìµ Sin conexi√≥n por 7+ d√≠as";
    
    ALERTA TIPO 3: Patr√≥n irregular
    "üîî Medicamento X olvidado >3 veces";
    
    ALERTA TIPO 4: Desvinculaci√≥n
    "‚õî Paciente paus√≥ compartici√≥n";
    
    :Cada alerta tiene:
    - Timestamp
    - Descripci√≥n
    - Nivel severidad
    - Acci√≥n sugerida;
  endif
}

partition "Acciones sobre Paciente" {
  :Panel de acciones;
  
  if (¬øAcci√≥n seleccionada?) then (Ver historial completo)
    :Abrir modal historial;
    :Calendario interactivo;
    :Exportar como PDF;
    
  elseif (Contactar paciente) then
    :Modal opciones contacto:
    - Ver email registrado
    - Generar mensaje plantilla
    - Marcar para seguimiento;
    
    note right
      No hay comunicaci√≥n
      directa desde la app
      por privacidad
    end note
    
  elseif (Agregar nota cl√≠nica) then
    :Campo de texto;
    :M√©dico escribe nota privada;
    :Solo visible para el m√©dico;
    
    :Guardar con timestamp;
    :Agregar a historial notas;
    
  elseif (Generar reporte) then
    :Modal configuraci√≥n reporte;
    
    :Seleccionar:
    - Per√≠odo (7/30/90 d√≠as)
    - Incluir gr√°ficos (S√≠/No)
    - Incluir notas cl√≠nicas (S√≠/No)
    - Formato (PDF/Excel);
    
    :Generar documento;
    :Descargar autom√°ticamente;
    
  else (Desvincular paciente)
    :Advertencia:
    "‚ö†Ô∏è ¬øDesvincular paciente?
    
    Esta acci√≥n:
    - Detendr√° monitoreo
    - Notificar√° al paciente
    - Mantendr√° historial archivado
    
    ¬øContinuar?";
    
    if (¬øConfirma?) then (S√≠)
      :Solicitar raz√≥n (opcional);
      :Desvincular;
      :Notificar paciente;
      :Mover a secci√≥n "Archivados";
    endif
  endif
}

partition "Sistema de Alertas" {
  :Badge en campana notificaciones;
  
  :Click campana;
  :Panel alertas desplegable;
  
  :Lista cronol√≥gica alertas;
  
  :Cada alerta muestra:
  - Paciente afectado
  - Tipo de alerta
  - Timestamp
  - Estado (Nueva/Vista/Resuelta);
  
  if (¬øClick en alerta?) then (S√≠)
    :Marcar como vista;
    :Navegar a detalle paciente;
    :Resaltar secci√≥n relevante;
  endif
  
  :Opci√≥n "Marcar todas como vistas";
  :Opci√≥n "Configurar alertas";
  
  if (¬øConfigurar alertas?) then (S√≠)
    :Modal preferencias;
    
    :Toggles por tipo:
    ‚òë Adherencia <70% por 3+ d√≠as
    ‚òë Sin conexi√≥n 7+ d√≠as
    ‚òë Medicamento olvidado >3 veces
    ‚òë Nueva solicitud vinculaci√≥n
    ‚òë Paciente se desvincul√≥;
    
    :Opci√≥n frecuencia resumen:
    - Tiempo real
    - Diario (8:00 AM)
    - Semanal (Lunes 8:00 AM);
    
    :Guardar preferencias;
  endif
}

:Dashboard actualizado;
:M√©dico puede continuar
monitoreando pacientes;

stop

@enduml
